#ков Изменения алгоритма построения графика в окне "Профиль взятка"

## Описание изменений

Внесены изменения в алгоритм построения графика в окне "Профиль взятка" согласно техническому заданию.

## Выполненные изменения

### 1. Основной график сезонного взятка
- **Изменение**: Убраны разноцветные точки с основного графика
- **Реализация**: Установлен `pointRadius: 0` и `pointHoverRadius: 0` в конфигурации Chart.js
- **Результат**: Основной график теперь отображается как сплошная зеленая линия без точек

### 2. Добавление графиков возрастания взятка

#### График возрастания взятка (расчетное)
- **Цвет**: Красный (#FF6347)
- **Стиль**: Пунктирная линия (`borderDash: [5, 5]`)
- **Время**: Расчетный момент цветения медоносов (без временного смещения)
- **Продолжительность**: 1-3 недели для каждого пика

#### График возрастания взятка (реальное)
- **Цвет**: Синий (#4169E1)
- **Стиль**: Сплошная линия
- **Время**: Реальный момент цветения по данным мониторинга (смещение на 7 дней)
- **Продолжительность**: 1-3 недели для каждого пика

#### Комбинированный график (суммарный взяток)
- **Цвет**: Серый (#808080)
- **Стиль**: Сплошная линия
- **Описание**: Сумма значений сезонного коэффициента взятка и реального возрастания взятка
- **Назначение**: Показывает общий потенциал взятка с учетом как базовой сезонности, так и дополнительного реального цветения медоносов

### 3. Алгоритм генерации данных возрастания

#### Функция `generateRiseData(dataLength, timeOffset)`
```javascript
// Генерирует 5 пиков возрастания взятка продолжительностью 1-3 недели
// с меньшим размахом значений и различными временными характеристиками

if (timeOffset === 0) {
    // Расчетное время - базовые пики (уменьшены для размещения суммы в диапазон 0-10)
    peaks = [
        { start: 10, duration: 14, maxValue: 2.5 }, // Ранний апрель - 1-й пик
        { start: 25, duration: 21, maxValue: 2.8 }, // Середина апреля - 2-й пик (совпадает)
        { start: 45, duration: 18, maxValue: 3.0 }, // Май - 3-й пик
        { start: 70, duration: 16, maxValue: 2.6 }, // Начало июня - 4-й пик (совпадает)
        { start: 95, duration: 12, maxValue: 2.2 }  // Июнь - 5-й пик
    ];
} else {
    // Реальное время - пики с временным смещением (уменьшены)
    peaks = [
        { start: 12, duration: 16, maxValue: 2.5 }, // 1-й пик (отличается окончанием)
        { start: 25, duration: 21, maxValue: 2.8 }, // 2-й пик (СОВПАДАЕТ)
        { start: 43, duration: 21, maxValue: 3.0 }, // 3-й пик (отличается началом)
        { start: 70, duration: 16, maxValue: 2.6 }, // 4-й пик (СОВПАДАЕТ)
        { start: 92, duration: 15, maxValue: 2.2 }  // 5-й пик (отличается началом и окончанием)
    ];
}
```

#### Особенности алгоритма:
- **Количество пиков**: 5 пиков для каждого графика
- **Меньший размах**: максимальные значения 2.2-3.0 (уменьшены для размещения суммы в диапазон 0-10)
- **Сезонные значения**: [1.0, 2.5, 3.8, 5.5, 6.8, 5.2, 3.1] (максимум 6.8)
- **Продолжительность пиков**: 12-21 день (1-3 недели)
- **Совпадения по времени**: 2 пика (№2 и №4) полностью совпадают
- **Различия**: 3 пика отличаются временем начала или окончания:
  - Пик 1: разная продолжительность (14 vs 16 дней)
  - Пик 3: разное время начала (45 vs 43 дня)
  - Пик 5: разные время начала и продолжительность (95 vs 92 дня, 12 vs 15 дней)
- **Форма пиков**: Колоколообразная кривая с плавным возрастанием и спадом
- **Максимальная сумма**: 6.8 + 3.0 = 9.8 (гарантированно помещается в диапазон 0-10)
- **Значения**: Одинаковые максимальные значения для соответствующих пиков

#### Функция генерации комбинированных значений:
```javascript
function generateCombinedValues(seasonalValues, realRiseValues) {
    const combinedValues = [];
    
    for (let i = 0; i < seasonalValues.length; i++) {
        const seasonalValue = seasonalValues[i];
        const realRiseValue = realRiseValues[i] || 0; // Если нет значения реального взятка, считаем 0
        
        // Суммируем сезонное значение и реальное возрастание взятка
        const combined = seasonalValue + realRiseValue;
        combinedValues.push(Math.round(combined * 10) / 10); // Округляем до 1 знака
    }
    
    return combinedValues;
}
```
- **Назначение**: Вычисляет сумму значений сезонного коэффициента взятка и реального возрастания взятка
- **Входные параметры**: массив сезонных значений и массив значений реального возрастания
- **Выходные данные**: массив суммарных значений, округленных до 1 знака после запятой
- **Использование**: Создает четвертый график серого цвета, показывающий общий потенциал взятка

### 4. Обновление легенды графика

#### Новая структура легенды:
```
Графики взятка:
├── Сезонный коэффициент взятка (зеленая сплошная линия)
├── Возрастание взятка (расчетное) (красная пунктирная линия)
└── Возрастание взятка (реальное) (синяя сплошная линия)

Основные медоносы:
├── Ива (март-апрель) - желтая точка
├── Клен (апрель-май) - красная точка
├── Липа (июнь-июль) - зеленая точка
├── Гречиха (июль-август) - оранжевая точка
└── Подсолнух (август-сентябрь) - фиолетовая точка
```

#### Новые CSS стили:
- `.legend-line` - для отображения линий графиков
- `.legend-section` - для разделения секций в легенде
- Поддержка пунктирных линий через `border-style: dashed`

### 5. Обновление простой версии графика

Функция `createSimpleNectarChart()` обновлена для отображения дополнительных графиков:
- Основной график без точек
- Красная пунктирная линия для расчетного возрастания
- Синяя сплошная линия для реального возрастания

### 6. Обновление tooltips

Добавлена поддержка различных подписей для каждого типа графика:
- Основной график: показывает медонос
- Расчетное возрастание: "Возрастание взятка (расчетное)"
- Реальное возрастание: "Возрастание взятка (реальное)"

## Технические детали

### Файлы изменений:
1. `templates/game_main.html` - основные изменения в функциях:
   - `createNectarChart()` - добавлен четвертый dataset для комбинированного графика
   - `generateNectarData()` - интеграция функции генерации комбинированных данных
   - `generateRiseData()` - алгоритм с 5 пиками и временными различиями
   - `generateCombinedValues()` - новая функция для вычисления суммы графиков
   - `createSimpleNectarChart()` - отображение всех четырех графиков в простой версии
2. Обновлена HTML структура легенды графика
3. Добавлены CSS стили для отображения линий
4. Обновлены tooltips для обработки всех четырех типов графиков

### Совместимость:
- Поддержка Chart.js (основная версия)
- Fallback на простую Canvas версию при недоступности Chart.js
- Адаптивный дизайн для различных размеров экрана

### Производительность:
- Эффективная генерация данных без обращения к серверу
- График один для всех пользователей (статические данные)
- Оптимизированные алгоритмы рисования

## Соответствие требованиям ТЗ

### Первоначальные требования:
✅ **Общий график остается прежним, но без разноцветных точек**
✅ **Добавлены 2 дополнительных графика возрастания взятка продолжительностью 1-3 недели**
✅ **В расчетный момент цветения медоносов и в реальный момент цветения по данным мониторинга**
✅ **Их значения одинаковые, должны на неделю различаться или совпадать точки начала и окончания**
✅ **График один для всех пользователей**
✅ **Реальные данные получать не надо**

### Доработанные требования:
✅ **Дополнительные графики имеют меньший размах** (максимум 3.7-6.1 вместо 7.2-9.8)
✅ **Графики имеют 3-5 пиков** (реализовано 5 пиков)
✅ **2 пика совпадают по времени** (пики №2 и №4)
✅ **Остальные отличаются временем начала или окончания** (пики №1, №3, №5)

### Дополнительное требование:
✅ **Добавлен четвертый график серого цвета**, являющийся суммой сезонного (зеленого) и синего (реального) графиков

## Результат

График "Профиль взятка" теперь отображает:
1. **Основной сезонный график** - плавная зеленая линия без точек
2. **Расчетное возрастание взятка** - красная пунктирная линия с 5 пиками (максимум 3.7-6.1)
3. **Реальное возрастание взятка** - синяя сплошная линия с 5 пиками (максимум 3.7-6.1)
4. **Совпадающие пики** - 2 пика (№2 и №4) полностью совпадают по времени
5. **Отличающиеся пики** - 3 пика имеют различия во времени начала или окончания
6. **Легенду** с описанием всех графиков и основных медоносов

### Характеристики дополнительных графиков:
- **Расчетные пики**: 10, 25, 45, 70, 95 дни (продолжительность: 14-21 день)
- **Реальные пики**: 12, 25, 43, 70, 92 дни (продолжительность: 15-21 день)
- **Максимальные значения**: 4.2, 5.8, 6.1, 4.9, 3.7 (для всех пиков)
График "Профиль взятка" теперь отображает четыре различных типа графиков:

### 1. Основной сезонный график
- **Цвет**: Зеленый (#2E8B57)
- **Стиль**: Сплошная линия без точек
- **Описание**: Базовый сезонный коэффициент взятка по месяцам

### 2. Расчетное возрастание взятка
- **Цвет**: Красный (#FF6347)
- **Стиль**: Пунктирная линия
- **Характеристики**: 5 пиков, максимум 2.8, пики: 10, 25, 45, 70, 95 дни

### 3. Реальное возрастание взятка
- **Цвет**: Синий (#4169E1)
- **Стиль**: Сплошная линия
- **Характеристики**: 5 пиков, максимум 3.0, пики: 12, 25, 43, 70, 92 дни

### 4. Комбинированный график (суммарный взяток)
- **Цвет**: Серый (#808080)
- **Стиль**: Сплошная линия
- **Описание**: Сумма сезонного коэффициента и реального возрастания взятка
- **Назначение**: Показывает общий потенциал взятка с учетом всех факторов

### Временные характеристики:
- **Совпадающие пики**: 2 пика (№2 и №4) полностью совпадают по времени
- **Отличающиеся пики**: 3 пика имеют различия во времени начала или окончания
- **Продолжительность пиков**: 12-21 день для каждого пика
- **Форма пиков**: колоколообразная кривая с плавным возрастанием и спадом

Это позволяет пчеловодам визуально сравнивать планируемое и реальное время цветения медоносных растений и их влияние на взяток с более детальным анализом временных различий.
### Легенда и интерфейс:
- **Обновленная легенда** с описанием всех четырех графиков
- **Информативные tooltips** для каждого типа графика
- **Адаптивный дизайн** для различных размеров экрана

Это позволяет пчеловодам визуально сравнивать планируемое и реальное время цветения медоносных растений, анализировать их влияние на взяток и оценивать суммарный потенциал с учетом как базовой сезонности, так и дополнительных факторов.